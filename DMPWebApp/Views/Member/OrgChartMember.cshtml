
@{
    ViewBag.Title = "Cây phân cấp thành viên";
}

@section css{
    <link rel="stylesheet" href="~/Assets/stylesheets/tree.css" />
}


<section role="main" class="content-body">
    <header class="page-header">
        <h2>Cây phân cấp thành viên</h2>

        <div class="right-wrapper pull-right">
            <ol class="breadcrumbs">
                <li>
                    <a href="index.html">
                        <i class="fa fa-home"></i>
                    </a>
                </li>
                <li><span>Quản lý cấp dưới</span></li>
                <li><span>Cây phân cấp thành viên</span></li>
            </ol>

            <a class="sidebar-right-toggle" data-open="sidebar-right"><i class="fa fa-chevron-left"></i></a>
        </div>
    </header>
    <!-- start: page -->
    <div class="row">
        <div id=body genealogy-body genealogy-scroll class="justify-content-center">
            <ul class="genealogy-tree">
            </ul>
        </div>
    </div>
    <!-- end: page -->
</section>

@section script{
    <script src="~/Assets/javascripts/tree/tree.js"></script>
    <script>
        $.get(`http://api.duocmyphamhaiduong.com/GetMember?id=${sessionStorage.getItem('userID')}`, function (boss) {
            
            $.get(`http://api.duocmyphamhaiduong.com/GetOrg?memberID=TV000001`, function (employees) {
                console.log(boss);
                console.log(employees);
                employees.splice(0, 0, boss[0])
                var data = employees.map(x => {
                    return {
                        id: x.MemberID,
                        pid: x.ReferralID,
                        name: x.FullName,
                        img: x.Avatar == null ? "https://image.flaticon.com/icons/svg/145/145867.svg" : x.Avatar
                    }
                });
                console.log(data);
                var orgTree = new OrgTree();
                orgTree.init(data);
                var bac2 = $($($(".genealogy-tree ul")[0]).find("ul")[0]).addClass("active");
                bac2.css("display", "block");

            });

        });
        
    </script>

}
